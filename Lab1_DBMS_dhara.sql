--create tables
CREATE TABLE DEPOSIT (
    ACTNO INT,
    CNAME VARCHAR(50),
    BNAME VARCHAR(50),
    AMOUNT DECIMAL(8,2),
    ADATE DATETIME
);
CREATE TABLE BRANCH (
    BNAME VARCHAR(50),
    CITY VARCHAR(50)
);
CREATE TABLE CUSTOMERS (
    CNAME VARCHAR(50),
    CITY VARCHAR(50)
);
CREATE TABLE BORROW (
    LOANNO INT,
    CNAME VARCHAR(50),
    BNAME VARCHAR(50),
    AMOUNT DECIMAL(8,2)
);


--insert data
INSERT INTO DEPOSIT (ACTNO, CNAME, BNAME, AMOUNT, ADATE)
VALUES
(101, 'ANIL', 'VRCE', 1000.00, '1995-03-01'),
(102, 'SUNIL', 'AJNI', 5000.00, '1996-01-04'),
(103, 'MEHUL', 'KAROLBAGH', 3500.00, '1995-11-17'),
(104, 'MADHURI', 'CHANDI', 1200.00, '1995-12-17'),
(105, 'PRMOD', 'M.G. ROAD', 3000.00, '1996-03-27'),
(106, 'SANDIP', 'ANDHERI', 2000.00, '1996-03-31'),
(107, 'SHIVANI', 'VIRAR', 1000.00, '1995-09-05'),
(108, 'KRANTI', 'NEHRU PLACE', 5000.00, '1995-07-02'),
(109, 'MINU', 'POWAI', 7000.00, '1995-08-10');


INSERT INTO BRANCH (BNAME, CITY)
VALUES
('VRCE', 'NAGPUR'),
('AJNI', 'NAGPUR'),
('KAROLBAGH', 'DELHI'),
('CHANDI', 'DELHI'),
('DHARAMPETH', 'NAGPUR'),
('M.G. ROAD', 'BANGLORE'),
('ANDHERI', 'BOMBAY'),
('VIRAR', 'BOMBAY'),
('NEHRU PLACE', 'DELHI'),
('POWAI', 'BOMBAY');


INSERT INTO CUSTOMERS (CNAME, CITY)
VALUES
('ANIL', 'CALCUTTA'),
('SUNIL', 'DELHI'),
('MEHUL', 'BARODA'),
('MANDAR', 'PATNA'),
('MADHURI', 'NAGPUR'),
('PRAMOD', 'NAGPUR'),
('SANDIP', 'SURAT'),
('SHIVANI', 'BOMBAY'),
('KRANTI', 'BOMBAY'),
('NAREN', 'BOMBAY');


INSERT INTO BORROW (LOANNO, CNAME, BNAME, AMOUNT)
VALUES
(201, 'ANIL', 'VRCE', 1000.00),
(206, 'MEHUL', 'AJNI', 5000.00),
(311, 'SUNIL', 'DHARAMPETH', 3000.00),
(321, 'MADHURI', 'ANDHERI', 2000.00),
(375, 'PRMOD', 'VIRAR', 8000.00),
(481, 'KRANTI', 'NEHRU PLACE', 3000.00);


--PART A questions *****************************************************************************************
SELECT * FROM DEPOSIT;

SELECT * FROM BORROW;

SELECT * FROM CUSTOMERS;

INSERT INTO BORROW (LOANNO, CNAME, BNAME, AMOUNT) VALUES (550, 'JAY', 'AJNI', NULL);

SELECT ACTNO, CNAME, AMOUNT FROM DEPOSIT;

SELECT LOANNO, AMOUNT FROM BORROW;

SELECT B.LOANNO, B.CNAME, B.BNAME, B.AMOUNT
FROM BORROW B
JOIN BRANCH BR ON B.BNAME = BR.BNAME
WHERE BR.BNAME = 'ANDHERI';

SELECT ACTNO, AMOUNT
FROM DEPOSIT
WHERE ACTNO = 106;

SELECT CNAME
FROM BORROW
WHERE AMOUNT > 5000;

SELECT CNAME
FROM DEPOSIT
WHERE ADATE > '1996-12-01';

SELECT CNAME
FROM DEPOSIT
WHERE ACTNO < 105;

SELECT CNAME
FROM CUSTOMERS
WHERE CITY IN ('NAGPUR', 'DELHI');

SELECT D.CNAME, D.BNAME
FROM DEPOSIT D
WHERE D.AMOUNT > 4000 AND D.ACTNO < 105;

SELECT *
FROM BORROW
WHERE AMOUNT BETWEEN 3000 AND 8000;

SELECT *
FROM DEPOSIT
WHERE BNAME <> 'ANDHERI';

SELECT ACTNO, CNAME, AMOUNT
FROM DEPOSIT
WHERE BNAME IN ('AJNI', 'KAROLBAGH', 'M.G. ROAD') AND ACTNO < 104;

SELECT TOP 5 * FROM CUSTOMERS;

SELECT TOP 3 *
FROM DEPOSIT
WHERE AMOUNT > 1000;

SELECT TOP 5 LOANNO, CNAME
FROM BORROW
WHERE BNAME <> 'ANDHERI';

SELECT DISTINCT CITY
FROM CUSTOMERS;

SELECT DISTINCT BNAME
FROM BRANCH;

SELECT *
FROM CUSTOMERS
ORDER BY CITY ASC;

SELECT *
FROM DEPOSIT
ORDER BY AMOUNT DESC;

UPDATE DEPOSIT
SET AMOUNT = 5000
WHERE AMOUNT = 3000;

UPDATE BORROW
SET BNAME = 'C.G. ROAD'
WHERE CNAME = 'ANIL' AND BNAME = 'VRCE';

UPDATE DEPOSIT
SET ACTNO = 111, AMOUNT = 5000
WHERE CNAME = 'SANDIP';

UPDATE BORROW
SET AMOUNT = AMOUNT * 1.10;

UPDATE DEPOSIT
SET AMOUNT = 5000
WHERE ACTNO BETWEEN 103 AND 107;

UPDATE BORROW
SET AMOUNT = NULL
WHERE LOANNO = 321;

SELECT CNAME
FROM BORROW
WHERE AMOUNT IS NULL;

--PART A questions finished*****************************************************************************************
--PART B questions *****************************************************************************************


-- Create the table student
CREATE TABLE STUDENT (
    RollNo INT PRIMARY KEY,
    Name VARCHAR(50),
    Birthdate DATE,
    SPI DECIMAL(4,2), 
    City VARCHAR(50),
    Backlog INT,
    Branch VARCHAR(10)
);

--inserting data into student table
INSERT INTO STUDENT (RollNo, Name, Birthdate, SPI, City, Backlog, Branch)
VALUES
(101, 'Keyur', '1992-01-05', 8.5, 'Rajkot', 2, 'CE'),
(102, 'Hardik', '1994-02-15', 9.0, 'Ahmedabad', 0, 'CE'),
(103, 'Kajal', '1996-03-14', 10.00, 'Baroda', 0, 'IT'),
(104, 'Bhoomi', '1995-06-23', 8.90, 'Ahmedabad', 1, 'ICT'),
(105, 'Harmit', '1994-02-15', 9.80, 'Rajkot', 1, 'IT'),
(106, 'Jay', '1994-02-15', 7.9, 'Rajkot', 2, 'CE');

SELECT RollNo, Name
FROM STUDENT
WHERE RollNo > 103
  AND Backlog > 0
  AND Branch IN ('CE', 'IT');

SELECT Name
FROM STUDENT
WHERE SPI BETWEEN 8 AND 9
  AND Branch IN ('CE', 'IT');

SELECT *
FROM STUDENT
WHERE Branch <> 'CE';

SELECT TOP 3 RollNo, Name
FROM STUDENT;

SELECT TOP 3 *
FROM STUDENT
WHERE SPI > 8.5;

SELECT DISTINCT City
FROM STUDENT;

SELECT DISTINCT Branch
FROM STUDENT;

SELECT *
FROM STUDENT
ORDER BY Backlog DESC, SPI ASC;

UPDATE STUDENT
SET Branch = 'MCA', City = 'Jamnagar'
WHERE Name = 'Jay';

UPDATE STUDENT
SET Backlog = NULL
WHERE Name IN ('Keyur', 'Bhoomi');

SELECT Name
FROM STUDENT
WHERE (Backlog IS NULL OR Backlog > 1)
  AND Branch IN ('CE', 'IT');
